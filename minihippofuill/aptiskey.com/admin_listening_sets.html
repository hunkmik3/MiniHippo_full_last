<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Listening Sets - Mini Hippo</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    
    <!-- Modern UI CSS -->
    <link rel="stylesheet" href="css/modern-ui.css">
    <link rel="stylesheet" href="css/lesson-ui.css">
    
    <style>
        body {
            background: #f3f4f6;
            color: #0f172a;
        }
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 1.5rem 4rem;
        }
        
        .upload-hero {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-radius: 1.25rem;
            padding: 2.5rem 2rem;
            margin-bottom: 2.5rem;
            border: 1px solid #cbd5f5;
            box-shadow: 0 20px 35px rgba(148, 163, 184, 0.25);
        }
        
        .form-section {
            background: white;
            padding: 2rem;
            border-radius: 1.2rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 12px 26px rgba(15, 23, 42, 0.06);
            margin-bottom: 2rem;
        }
        
        .question-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }
        
        .empty-state-notice {
            text-align: center;
            padding: 3rem;
            color: #64748b;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="upload-hero">
            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                <div>
                    <h1 class="mb-2">Quản lý Bộ Đề Listening</h1>
                    <p class="text-muted mb-0">Tạo và quản lý các bộ đề listening cho trang học theo bộ đề.</p>
                </div>
                <div class="d-flex gap-2 flex-wrap">
                    <button type="button" class="btn btn-outline-primary" id="refreshListeningSetsBtn">
                        <i class="bi bi-arrow-repeat me-2"></i>Tải lại danh sách
                    </button>
                    <button type="button" class="btn btn-primary" id="createListeningSetBtn">
                        <i class="bi bi-plus-circle me-2"></i>Tạo bộ đề mới
                    </button>
                </div>
            </div>
        </div>

        <div id="listening-set-list" class="mb-4"></div>
        <div id="listening-set-empty" class="empty-state-notice" style="display: none;">
            <i class="bi bi-info-circle me-2"></i>Chưa có bộ đề listening nào. Hãy tạo bộ đề đầu tiên của bạn.
        </div>

        <div id="listening-set-form-card" class="card" style="display: none;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0" id="listening-set-form-title">Tạo bộ đề Listening</h5>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="cancelListeningSetBtn">
                        <i class="bi bi-x-lg me-1"></i>Đóng
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Tiêu đề bộ đề</label>
                        <input type="text" class="form-control" id="listening-set-title" placeholder="Ví dụ: Bộ đề Listening #001">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label fw-bold">Thời lượng (phút)</label>
                        <input type="number" class="form-control" id="listening-set-duration" min="10" max="60" value="35">
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-bold">Mô tả ngắn</label>
                        <textarea class="form-control" id="listening-set-description" rows="2" placeholder="Thông tin nổi bật..."></textarea>
                    </div>
                </div>

                <div class="accordion mt-4" id="listeningSetAccordion">
                    <!-- Part 1: Questions 1-13 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPart1">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePart1" aria-expanded="true">
                                Question 1 (Questions 1-13)
                            </button>
                        </h2>
                        <div id="collapsePart1" class="accordion-collapse collapse show" data-bs-parent="#listeningSetAccordion">
                            <div class="accordion-body">
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Số lượng câu hỏi (1-13)</label>
                                    <input type="number" class="form-control" id="listening-part1-count" min="1" max="13" value="13">
                                </div>
                                <div id="listening-part1-questions" class="mb-3"></div>
                                <button type="button" class="btn btn-outline-primary btn-sm" id="addListeningPart1QuestionBtn">
                                    <i class="bi bi-plus-circle me-1"></i>Thêm câu hỏi
                                </button>
                                <div class="form-text mt-2">Mỗi câu hỏi cần: audio URL, câu hỏi, 3 lựa chọn, đáp án đúng, transcript.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Part 2: Question 14 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPart2">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePart2">
                                Question 2 (Question 14)
                            </button>
                        </h2>
                        <div id="collapsePart2" class="accordion-collapse collapse" data-bs-parent="#listeningSetAccordion">
                            <div class="accordion-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Topic</label>
                                        <input type="text" class="form-control" id="listening-part2-topic" placeholder="Ví dụ: Shopping">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Chọn file MP3</label>
                                        <input type="file" class="form-control" id="listening-part2-audio-file" accept="audio/mp3,audio/mpeg,.mp3">
                                        <input type="hidden" id="listening-part2-audio" value="">
                                        <div class="form-text">Hoặc nhập URL: <input type="text" class="form-control mt-1" id="listening-part2-audio-url" placeholder="audio/question14/audio_q1.mp3"></div>
                                        <div id="listening-part2-audio-status" class="mt-2"></div>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Options (6 options, mỗi option một dòng)</label>
                                        <textarea class="form-control" id="listening-part2-options" rows="6" placeholder="Option 1&#10;Option 2&#10;..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Correct Answers (4 answers, mỗi answer một dòng cho Person 1, 2, 3, 4)</label>
                                        <textarea class="form-control" id="listening-part2-answers" rows="4" placeholder="Person 1 answer&#10;Person 2 answer&#10;..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Transcript</label>
                                        <textarea class="form-control" id="listening-part2-transcript" rows="8"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Part 3: Question 15 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPart3">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePart3">
                                Question 3 (Question 15)
                            </button>
                        </h2>
                        <div id="collapsePart3" class="accordion-collapse collapse" data-bs-parent="#listeningSetAccordion">
                            <div class="accordion-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Topic</label>
                                        <input type="text" class="form-control" id="listening-part3-topic" placeholder="Ví dụ: Changes in the workplace">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Chọn file MP3</label>
                                        <input type="file" class="form-control" id="listening-part3-audio-file" accept="audio/mp3,audio/mpeg,.mp3">
                                        <input type="hidden" id="listening-part3-audio" value="">
                                        <div class="form-text">Hoặc nhập URL: <input type="text" class="form-control mt-1" id="listening-part3-audio-url" placeholder="audio/question15/audio_q1.mp3"></div>
                                        <div id="listening-part3-audio-status" class="mt-2"></div>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Questions (4 questions, mỗi question một dòng)</label>
                                        <textarea class="form-control" id="listening-part3-questions" rows="4" placeholder="Question 1&#10;Question 2&#10;..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Correct Answers (Man/Woman/Both, mỗi answer một dòng)</label>
                                        <textarea class="form-control" id="listening-part3-answers" rows="4" placeholder="Man&#10;Woman&#10;Both&#10;Man"></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Transcript</label>
                                        <textarea class="form-control" id="listening-part3-transcript" rows="10"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Part 4: Questions 16-17 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPart4">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePart4">
                                Question 4 (Questions 16-17)
                            </button>
                        </h2>
                        <div id="collapsePart4" class="accordion-collapse collapse" data-bs-parent="#listeningSetAccordion">
                            <div class="accordion-body">
                                <div id="listening-part4-questions" class="mb-3"></div>
                                <button type="button" class="btn btn-outline-primary btn-sm" id="addListeningPart4QuestionBtn">
                                    <i class="bi bi-plus-circle me-1"></i>Thêm câu hỏi (tối đa 2)
                                </button>
                                <div class="form-text mt-2">Mỗi câu hỏi (16 hoặc 17) cần: audio URL, topic, các câu hỏi con với options, transcript.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 d-flex gap-2 justify-content-end">
                    <button type="button" class="btn btn-secondary" id="cancelListeningSetBtn2">Hủy</button>
                    <button type="button" class="btn btn-primary" id="saveListeningSetBtn">
                        <i class="bi bi-save me-2"></i>Lưu bộ đề
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/admin_upload_v2.js"></script>
    <script src="js/admin_listening_sets.js"></script>
</body>
</html>

